GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
  | Name    | Type           | Params
-------------------------------------------
0 | model   | LeNet5         | 4.3 M
1 | val_acc | BinaryAccuracy | 0
-------------------------------------------
4.3 M     Trainable params
0         Non-trainable params
4.3 M     Total params
17.017    Total estimated model params size (MB)

Sanity Checking: 0it [00:00, ?it/s]








































Epoch 0: 100%|██████████████████████████████████████████████████████████| 444/444 [01:42<00:00,  4.35it/s, v_num=2]















































Epoch 1: 100%|██████████████████████████████████████████████████████████| 444/444 [03:18<00:00,  2.23it/s, v_num=2]





















































Epoch 2: 100%|██████████████████████████████████████████████████████████| 444/444 [03:10<00:00,  2.33it/s, v_num=2]















































Epoch 3: 100%|██████████████████████████████████████████████████████████| 444/444 [02:26<00:00,  3.03it/s, v_num=2]















































Epoch 4: 100%|██████████████████████████████████████████████████████████| 444/444 [02:30<00:00,  2.95it/s, v_num=2]
















































Epoch 5: 100%|██████████████████████████████████████████████████████████| 444/444 [02:28<00:00,  3.00it/s, v_num=2]















































Epoch 6: 100%|██████████████████████████████████████████████████████████| 444/444 [02:27<00:00,  3.01it/s, v_num=2]















































Epoch 7: 100%|██████████████████████████████████████████████████████████| 444/444 [02:21<00:00,  3.14it/s, v_num=2]
















































Epoch 8: 100%|██████████████████████████████████████████████████████████| 444/444 [02:29<00:00,  2.96it/s, v_num=2]



















































Epoch 9: 100%|██████████████████████████████████████████████████████████| 444/444 [02:33<00:00,  2.90it/s, v_num=2]




Validation DataLoader 0:  98%|██████████████████████████████████████████████████ | 109/111 [00:08<00:00, 12.86it/s]

`Trainer.fit` stopped: `max_epochs=10` reached.
FIT Profiler Report
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                         	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                          	|  -              	|  175795         	|  1845.0         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                             	|  173.7          	|  10             	|  1737.0         	|  94.142         	|
|  run_training_batch                                                                                                                                             	|  0.18984        	|  4440           	|  842.89         	|  45.685         	|
|  [LightningModule]BPSClassifier.optimizer_step                                                                                                                  	|  0.18972        	|  4440           	|  842.34         	|  45.655         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                        	|  0.084652       	|  4440           	|  375.86         	|  20.371         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                   	|  0.063822       	|  4440           	|  283.37         	|  15.358         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                 	|  0.069588       	|  1112           	|  77.382         	|  4.1941         	|
|  [_EvaluationLoop].val_next                                                                                                                                     	|  0.013601       	|  1113           	|  15.138         	|  0.82048        	|
|  [LightningModule]BPSClassifier.optimizer_zero_grad                                                                                                             	|  0.0016276      	|  4440           	|  7.2263         	|  0.39166        	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                   	|  0.0013986      	|  4440           	|  6.2097         	|  0.33656        	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                     	|  0.0010938      	|  4440           	|  4.8565         	|  0.26322        	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                              	|  0.0019992      	|  1112           	|  2.2232         	|  0.12049        	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.16382        	|  10             	|  1.6382         	|  0.088791       	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                 	|  0.00022678     	|  5552           	|  1.2591         	|  0.068243       	|
|  [LightningModule]BPSClassifier.transfer_batch_to_device                                                                                                        	|  0.00016833     	|  5552           	|  0.93458        	|  0.050654       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  5.3637e-05     	|  4440           	|  0.23815        	|  0.012908       	|
|  [LightningModule]BPSClassifier.configure_gradient_clipping                                                                                                     	|  3.7042e-05     	|  4440           	|  0.16447        	|  0.0089141      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                    	|  0.0054876      	|  11             	|  0.060363       	|  0.0032717      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                      	|  1.1494e-05     	|  4440           	|  0.051034       	|  0.002766       	|
|  [LightningModule]BPSClassifier.on_train_batch_end                                                                                                              	|  1.0975e-05     	|  4440           	|  0.048727       	|  0.002641       	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                    	|  6.7442e-06     	|  4440           	|  0.029944       	|  0.001623       	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                            	|  2.345e-05      	|  1112           	|  0.026076       	|  0.0014133      	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                  	|  5.2194e-06     	|  4440           	|  0.023174       	|  0.001256       	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                   	|  4.8358e-06     	|  4440           	|  0.021471       	|  0.0011637      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                  	|  0.0016535      	|  11             	|  0.018189       	|  0.00098583     	|
|  [LightningModule]BPSClassifier.on_before_batch_transfer                                                                                                        	|  3.1142e-06     	|  5552           	|  0.01729        	|  0.00093712     	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                 	|  3.7756e-06     	|  4440           	|  0.016764       	|  0.00090858     	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                	|  0.015896       	|  1              	|  0.015896       	|  0.00086157     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                 	|  1.4194e-05     	|  1112           	|  0.015783       	|  0.00085546     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  2.8824e-06     	|  4440           	|  0.012798       	|  0.00069365     	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                             	|  2.6554e-06     	|  4440           	|  0.01179        	|  0.00063901     	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                     	|  2.614e-06      	|  4440           	|  0.011606       	|  0.00062905     	|
|  [LightningModule]BPSClassifier.on_after_batch_transfer                                                                                                         	|  1.9859e-06     	|  5552           	|  0.011026       	|  0.0005976      	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                 	|  0.0010757      	|  10             	|  0.010757       	|  0.00058303     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  2.3821e-06     	|  4440           	|  0.010577       	|  0.00057325     	|
|  [LightningModule]BPSClassifier.on_validation_model_eval                                                                                                        	|  0.00095406     	|  11             	|  0.010495       	|  0.00056881     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  2.345e-06      	|  4440           	|  0.010412       	|  0.00056432     	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                      	|  2.3288e-06     	|  4440           	|  0.01034        	|  0.00056042     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  8.8847e-06     	|  1112           	|  0.0098797      	|  0.00053548     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  2.1485e-06     	|  4440           	|  0.0095393      	|  0.00051703     	|
|  [LightningModule]BPSClassifier.on_before_zero_grad                                                                                                             	|  2.1324e-06     	|  4440           	|  0.009468       	|  0.00051316     	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                   	|  0.00091007     	|  10             	|  0.0091007      	|  0.00049325     	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                       	|  1.9705e-06     	|  4440           	|  0.0087492      	|  0.0004742      	|
|  [LightningModule]BPSClassifier.on_before_backward                                                                                                              	|  1.7995e-06     	|  4440           	|  0.0079897      	|  0.00043304     	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                    	|  1.7944e-06     	|  4440           	|  0.007967       	|  0.00043181     	|
|  [LightningModule]BPSClassifier.on_after_backward                                                                                                               	|  1.6667e-06     	|  4440           	|  0.0074         	|  0.00040108     	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                	|  1.6237e-06     	|  4440           	|  0.0072094      	|  0.00039074     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  1.6138e-06     	|  4440           	|  0.0071653      	|  0.00038835     	|
|  [LightningModule]BPSClassifier.on_train_batch_start                                                                                                            	|  1.4886e-06     	|  4440           	|  0.0066092      	|  0.00035822     	|
|  [LightningModule]BPSClassifier.on_before_optimizer_step                                                                                                        	|  1.2777e-06     	|  4440           	|  0.0056731      	|  0.00030748     	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                            	|  1.2508e-06     	|  4440           	|  0.0055534      	|  0.00030099     	|
|  [LightningModule]BPSClassifier.on_validation_batch_end                                                                                                         	|  3.3388e-06     	|  1112           	|  0.0037127      	|  0.00020123     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                               	|  3.1604e-06     	|  1112           	|  0.0035143      	|  0.00019048     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  2.4418e-06     	|  1112           	|  0.0027153      	|  0.00014717     	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                            	|  0.002468       	|  1              	|  0.002468       	|  0.00013376     	|
|  [LightningModule]BPSClassifier.on_validation_batch_start                                                                                                       	|  1.7246e-06     	|  1112           	|  0.0019178      	|  0.00010394     	|
|  [LightningModule]BPSClassifier.on_validation_model_train                                                                                                       	|  0.00012785     	|  11             	|  0.0014063      	|  7.6223e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  0.00011418     	|  11             	|  0.001256       	|  6.8076e-05     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                       	|  0.0011925      	|  1              	|  0.0011925      	|  6.4632e-05     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                         	|  0.00062005     	|  1              	|  0.00062005     	|  3.3607e-05     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                     	|  2.4362e-05     	|  11             	|  0.00026798     	|  1.4524e-05     	|
|  [LightningModule]BPSClassifier.configure_optimizers                                                                                                            	|  0.00020605     	|  1              	|  0.00020605     	|  1.1168e-05     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                   	|  0.00010936     	|  1              	|  0.00010936     	|  5.9274e-06     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                   	|  8.1187e-06     	|  10             	|  8.1187e-05     	|  4.4003e-06     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                       	|  6.9704e-06     	|  11             	|  7.6674e-05     	|  4.1557e-06     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                    	|  6.2992e-06     	|  10             	|  6.2992e-05     	|  3.4141e-06     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                      	|  5.8172e-06     	|  10             	|  5.8172e-05     	|  3.1529e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  4.6668e-06     	|  11             	|  5.1335e-05     	|  2.7823e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  4.9278e-05     	|  1              	|  4.9278e-05     	|  2.6709e-06     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                              	|  4.3183e-06     	|  11             	|  4.7501e-05     	|  2.5745e-06     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                             	|  4.2113e-06     	|  11             	|  4.6324e-05     	|  2.5107e-06     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                              	|  4.4e-05        	|  1              	|  4.4e-05        	|  2.3848e-06     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                           	|  4.1421e-05     	|  1              	|  4.1421e-05     	|  2.245e-06      	|
|  [LightningModule]BPSClassifier.on_validation_start                                                                                                             	|  3.7258e-06     	|  11             	|  4.0984e-05     	|  2.2213e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  3.357e-06      	|  11             	|  3.6927e-05     	|  2.0014e-06     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                      	|  3.582e-06      	|  10             	|  3.582e-05      	|  1.9414e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  3.5792e-06     	|  10             	|  3.5792e-05     	|  1.9399e-06     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                            	|  2.9796e-06     	|  11             	|  3.2776e-05     	|  1.7764e-06     	|
|  [LightningModule]BPSClassifier.on_train_epoch_start                                                                                                            	|  2.7672e-06     	|  10             	|  2.7672e-05     	|  1.4998e-06     	|
|  [LightningModule]BPSClassifier.on_train_epoch_end                                                                                                              	|  2.6268e-06     	|  10             	|  2.6268e-05     	|  1.4237e-06     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                 	|  2.3762e-06     	|  11             	|  2.6138e-05     	|  1.4167e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  2.1015e-06     	|  11             	|  2.3117e-05     	|  1.2529e-06     	|
|  [LightningModule]BPSClassifier.on_validation_end                                                                                                               	|  2.0345e-06     	|  11             	|  2.238e-05      	|  1.213e-06      	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                               	|  2.0258e-06     	|  11             	|  2.2284e-05     	|  1.2078e-06     	|
|  [LightningModule]BPSClassifier.on_validation_epoch_start                                                                                                       	|  1.8032e-06     	|  11             	|  1.9835e-05     	|  1.0751e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  1.9335e-06     	|  10             	|  1.9335e-05     	|  1.0479e-06     	|
|  [LightningModule]BPSClassifier.on_validation_epoch_end                                                                                                         	|  1.7447e-06     	|  11             	|  1.9192e-05     	|  1.0402e-06     	|
|  [LightningModule]BPSClassifier.on_save_checkpoint                                                                                                              	|  1.7075e-06     	|  10             	|  1.7075e-05     	|  9.2546e-07     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                               	|  1.4609e-06     	|  11             	|  1.607e-05      	|  8.7099e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  1.3002e-05     	|  1              	|  1.3002e-05     	|  7.047e-07      	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                  	|  1.1593e-05     	|  1              	|  1.1593e-05     	|  6.2834e-07     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                          	|  1.0927e-05     	|  1              	|  1.0927e-05     	|  5.9224e-07     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                             	|  1.0073e-05     	|  1              	|  1.0073e-05     	|  5.4595e-07     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                            	|  7.867e-06      	|  1              	|  7.867e-06      	|  4.2639e-07     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                         	|  6.988e-06      	|  1              	|  6.988e-06      	|  3.7875e-07     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                	|  6.455e-06      	|  1              	|  6.455e-06      	|  3.4986e-07     	|
|  [LightningModule]BPSClassifier.on_fit_end                                                                                                                      	|  6.091e-06      	|  1              	|  6.091e-06      	|  3.3013e-07     	|
|  [LightningModule]BPSClassifier.on_train_start                                                                                                                  	|  5.508e-06      	|  1              	|  5.508e-06      	|  2.9853e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  5.472e-06      	|  1              	|  5.472e-06      	|  2.9658e-07     	|
|  [LightningModule]BPSClassifier.configure_callbacks                                                                                                             	|  5.053e-06      	|  1              	|  5.053e-06      	|  2.7387e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  4.857e-06      	|  1              	|  4.857e-06      	|  2.6325e-07     	|
|  [Callback]ModelSummary.teardown                                                                                                                                	|  4.844e-06      	|  1              	|  4.844e-06      	|  2.6254e-07     	|
|  [LightningModule]BPSClassifier.teardown                                                                                                                        	|  4.785e-06      	|  1              	|  4.785e-06      	|  2.5935e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  4.497e-06      	|  1              	|  4.497e-06      	|  2.4374e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  4.271e-06      	|  1              	|  4.271e-06      	|  2.3149e-07     	|
|  [LightningModule]BPSClassifier.on_fit_start                                                                                                                    	|  4.214e-06      	|  1              	|  4.214e-06      	|  2.284e-07      	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                     	|  3.662e-06      	|  1              	|  3.662e-06      	|  1.9848e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                    	|  3.485e-06      	|  1              	|  3.485e-06      	|  1.8889e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  2.96e-06       	|  1              	|  2.96e-06       	|  1.6043e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  2.793e-06      	|  1              	|  2.793e-06      	|  1.5138e-07     	|
|  [LightningModule]BPSClassifier.setup                                                                                                                           	|  2.484e-06      	|  1              	|  2.484e-06      	|  1.3463e-07     	|
|  [LightningModule]BPSClassifier.prepare_data                                                                                                                    	|  2.424e-06      	|  1              	|  2.424e-06      	|  1.3138e-07     	|
|  [Callback]ModelSummary.setup                                                                                                                                   	|  2.424e-06      	|  1              	|  2.424e-06      	|  1.3138e-07     	|
|  [LightningModule]BPSClassifier.on_train_end                                                                                                                    	|  2.218e-06      	|  1              	|  2.218e-06      	|  1.2021e-07     	|
|  [LightningModule]BPSClassifier.configure_sharded_model                                                                                                         	|  1.895e-06      	|  1              	|  1.895e-06      	|  1.0271e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                  	|  1.826e-06      	|  1              	|  1.826e-06      	|  9.8969e-08     	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs